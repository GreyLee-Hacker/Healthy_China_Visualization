$(function () {
    function map() {
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('map_1'));

        var option = {
            tooltip: {
                trigger: 'item',
                formatter: '{b}'
            },
            geo: {
                map: 'china',
                label: {
                    emphasis: {
                        show: true,
                        color: '#fff'
                    }
                },
                roam: true,
                itemStyle: {
                    normal: {
                        areaColor: '#4c60ff',
                        borderColor: '#002097'
                    },
                    emphasis: {
                        areaColor: '#ffeb7b'
                    }
                }
            },
            series: []
        };

        myChart.setOption(option);

        // 监听地图的点击事件
        myChart.on('click', function (params) {
            if (params.name) {
                createProvincePopup(params.name);
            }
        });

        window.addEventListener("resize", function () {
            myChart.resize();
        });
    }

    // 定义内蒙古数据
    const nmData = [
        { "省市名称": "内蒙古", "年份": "2016年", "总得分": 13.8480981247, "政策数量": 3.6556266988, "政策质量": 43.7808290696, "协同机制": 0.4274898156, "防控重大疾病": 5, "全方位干预健康影响因素": 4, "维护全生命周期健康": 2, "按时完成率": 15.2173913043, "总体完成率": 93.4782608696, "平均完成月数": 33.9302325581, "发文联合率": 0.0, "平均协作规模": 1.0, "参与部门数量": 6 },
        { "省市名称": "内蒙古", "年份": "2017年", "总得分": 19.5624813032, "政策数量": 5.4553124008, "政策质量": 50.1096438741, "协同机制": 19.1824665241, "防控重大疾病": 5, "全方位干预健康影响因素": 3, "维护全生命周期健康": 4, "按时完成率": 28.2608695652, "总体完成率": 93.4782608696, "平均完成月数": 23.8604651163, "发文联合率": 14.2857142857, "平均协作规模": 1.1428571429, "参与部门数量": 9 },
        { "省市名称": "内蒙古", "年份": "2018年", "总得分": 17.361501082, "政策数量": 9.7536682133, "政策质量": 50.1096438741, "协同机制": 7.2113283235, "防控重大疾病": 25, "全方位干预健康影响因素": 16, "维护全生命周期健康": 18, "按时完成率": 28.2608695652, "总体完成率": 93.4782608696, "平均完成月数": 23.8604651163, "发文联合率": 23.8095238095, "平均协作规模": 1.6825396825, "参与部门数量": 27 },
        { "省市名称": "内蒙古", "年份": "2019年", "总得分": 24.1681953139, "政策数量": 8.1232892647, "政策质量": 50.2525049213, "协同机制": 31.181746332, "防控重大疾病": 16, "全方位干预健康影响因素": 14, "维护全生命周期健康": 7, "按时完成率": 47.8260869565, "总体完成率": 86.9565217391, "平均完成月数": 17.575, "发文联合率": 16.6666666667, "平均协作规模": 1.5238095238, "参与部门数量": 17 },
        { "省市名称": "内蒙古", "年份": "2020年", "总得分": 37.3604998637, "政策数量": 14.6814534833, "政策质量": 63.5294995496, "协同机制": 54.9603852824, "防控重大疾病": 25, "全方位干预健康影响因素": 14, "维护全生命周期健康": 16, "按时完成率": 47.8260869565, "总体完成率": 86.9565217391, "平均完成月数": 15.275, "发文联合率": 22.4137931034, "平均协作规模": 2.0862068966, "参与部门数量": 30 },
        { "省市名称": "内蒙古", "年份": "2021年", "总得分": 28.053597208, "政策数量": 9.2935455093, "政策质量": 56.4423145234, "协同机制": 36.8554910526, "防控重大疾病": 8, "全方位干预健康影响因素": 15, "维护全生命周期健康": 19, "按时完成率": 41.3043478261, "总体完成率": 71.7391304348, "平均完成月数": 13.2727272727, "发文联合率": 21.2765957447, "平均协作规模": 1.9574468085, "参与部门数量": 26 },
        { "省市名称": "内蒙古", "年份": "2022年", "总得分": 30.762451122, "政策数量": 12.6321717378, "政策质量": 56.0781690892, "协同机制": 41.241867553, "防控重大疾病": 3, "全方位干预健康影响因素": 11, "维护全生命周期健康": 7, "按时完成率": 28.2608695652, "总体完成率": 67.3913043478, "平均完成月数": 13.4193548387, "发文联合率": 9.375, "平均协作规模": 1.6875, "参与部门数量": 23 },
        { "省市名称": "内蒙古", "年份": "2023年", "总得分": 43.7691021145, "政策数量": 16.4221924973, "政策质量": 60.2763015452, "协同机制": 77.4177952975, "防控重大疾病": 13, "全方位干预健康影响因素": 32, "维护全生命周期健康": 31, "按时完成率": 58.6956521739, "总体完成率": 65.2173913043, "平均完成月数": 5.6666666667, "发文联合率": 10.7438016529, "平均协作规模": 1.173553719, "参与部门数量": 24 }
    ];

    function createProvincePopup(province) {
        // 使用fetch加载对应省份的数据
        let provinceData;

        if (province === '内蒙古') {
            provinceData = nmData;
        } else if (province === '安徽') {
            provinceData = [
                { "省市名称": "安徽", "年份": "2016年", "总得分": 41.9978584275, "政策数量": 24.2529053219, "政策质量": 49.548572971, "协同机制": 59.8673247292, "防控重大疾病": 0, "全方位干预健康影响因素": 5, "维护全生命周期健康": 2, "按时完成率": 21.7391304348, "总体完成率": 97.8260869565, "平均完成月数": 33.3777777778, "发文联合率": 0.0, "平均协作规模": 1.0, "参与部门数量": 3 },
                { "省市名称": "安徽", "年份": "2017年", "总得分": 39.1809892548, "政策数量": 28.0691106009, "政策质量": 61.1064357826, "协同机制": 44.9190013932, "防控重大疾病": 18, "全方位干预健康影响因素": 14, "维护全生命周期健康": 10, "按时完成率": 50.0, "总体完成率": 97.8260869565, "平均完成月数": 24.4, "发文联合率": 17.3913043478, "平均协作规模": 1.2608695652, "参与部门数量": 12 },
                { "省市名称": "安徽", "年份": "2018年", "总得分": 44.569907586, "政策数量": 30.1833758144, "政策质量": 61.1064357826, "协同机制": 56.5327288563, "防控重大疾病": 6, "全方位干预健康影响因素": 11, "维护全生命周期健康": 2, "按时完成率": 50.0, "总体完成率": 97.8260869565, "平均完成月数": 24.4, "发文联合率": 29.1666666667, "平均协作规模": 1.5, "参与部门数量": 16 },
                { "省市名称": "安徽", "年份": "2019年", "总得分": 58.1998540941, "政策数量": 54.1496466337, "政策质量": 61.3240866555, "协同机制": 64.3206112561, "防控重大疾病": 8, "全方位干预健康影响因素": 14, "维护全生命周期健康": 11, "按时完成率": 56.5217391304, "总体完成率": 89.1304347826, "平均完成月数": 18.2195121951, "发文联合率": 19.4444444444, "平均协作规模": 1.7222222222, "参与部门数量": 24 },
                { "省市名称": "安徽", "年份": "2020年", "总得分": 71.8425803002, "政策数量": 93.0057470726, "政策质量": 73.8645356701, "协同机制": 57.8925584476, "防控重大疾病": 9, "全方位干预健康影响因素": 11, "维护全生命周期健康": 11, "按时完成率": 43.4782608696, "总体完成率": 84.7826086957, "平均完成月数": 18.5384615385, "发文联合率": 21.875, "平均协作规模": 1.6875, "参与部门数量": 23 },
                { "省市名称": "安徽", "年份": "2021年", "总得分": 67.3875817514, "政策数量": 73.8936942405, "政策质量": 84.9304809287, "协同机制": 61.9930132046, "防控重大疾病": 7, "全方位干预健康影响因素": 15, "维护全生命周期健康": 22, "按时完成": 45.652173913, "总体完成率": 80.4347826087, "平均完成月数": 14.3513513514, "发文联合率": 32.6086956522, "平均协作规模": 2.2826086957, "参与部门数量": 31 },
                { "省市名称": "安徽", "年份": "2022年", "总得分": 68.0808548686, "政策数量": 75.4343704986, "政策质量": 92.5848505098, "协同机制": 62.1521907227, "防控重大疾病": 4, "全方位干预健康影响因素": 20, "维护全生命周期健康": 16, "按时完成率": 43.4782608696, "总体完成率": 78.2608695652, "平均完成月数": 10.25, "发文联合率": 36.170212766, "平均协作规模": 2.1063829787, "参与部门数量": 29 },
                { "省市名称": "安徽", "年份": "2023年", "总得分": 81.5569409048, "政策数量": 81.9258155176, "政策质量": 97.3474325483, "协同机制": 77.4844711643, "防控重大疾病": 20, "全方位干预健康影响因素": 16, "维护全生命周期健康": 19, "按时完成率": 67.3913043478, "总体完成率": 69.5652173913, "平均完成月数": 5.4375, "发文联合率": 33.3333333333, "平均协作规模": 2.1290322581, "参与部门数量": 43 }
            ];
        } else if (province === '北京') {
            provinceData = [
                { "省市名称": "北京", "年份": "2016年", "总得分": 15.8438378339, "政策数量": 2.1142652135, "政策质量": 49.2605334365, "协同机制": 0.8549796312, "防控重大疾病": 2, "全方位干预健康影响因素": 9, "维护全生命周期健康": 16, "按时完成率": 32.6086956522, "总体完成率": 97.8260869565, "平均完成月数": 24.8888888889, "发文联合率": 41.3793103448, "平均协作规模": 1.9310344828, "参与部门数量": 19 },
                { "省市名称": "北京", "年份": "2017年", "总得分": 27.7725492181, "政策数量": 19.09674701, "政策质量": 70.8605496054, "协同机制": 19.0663923159, "防控重大疾病": 9, "全方位干预健康影响因素": 15, "维护全生命周期健康": 19, "按时完成率": 56.5217391304, "总体完成率": 97.8260869565, "平均完成月数": 18.9333333333, "发文联合率": 38.0, "平均协作规模": 1.94, "参与部门数量": 27 },
                { "省市名称": "北京", "年份": "2018年", "总得分": 28.957718065, "政策数量": 7.8516653918, "政策质量": 70.8605496054, "协同机制": 31.5333287825, "防控重大疾病": 5, "全方位干预健康影响因素": 17, "维护全生命周期健康": 8, "按时完成率": 56.5217391304, "总体完成率": 97.8260869565, "平均完成月数": 18.9333333333, "发文联合率": 12.5, "平均协作规模": 1.21875, "参与部门数量": 12 },
                { "省市名称": "北京", "年份": "2019年", "总得分": 29.6704614053, "政策数量": 12.8381269154, "政策质量": 73.4820918211, "协同机制": 32.9968710927, "防控重大疾病": 13, "全方位干预健康影响因素": 27, "维护全生命周期健康": 23, "按时完成率": 69.5652173913, "总体完成率": 97.8260869565, "平均完成月数": 12.9333333333, "发文联合率": 23.5294117647, "平均协作规模": 1.8823529412, "参与部门数量": 32 },
                { "省市名称": "北京", "年份": "2020年", "总得分": 28.2246408162, "政策数量": 12.5961837829, "政策质量": 62.8473752944, "协同机制": 33.4022584184, "防控重大疾病": 14, "全方位干预健康影响因素": 15, "维护全生命周期健康": 22, "按时完成率": 54.347826087, "总体完成率": 95.652173913, "平均完成月数": 13.6136363636, "发文联合率": 22.8070175439, "平均协作规模": 1.4736842105, "参与部门数量": 18 },
                { "省市名称": "北京", "年份": "2021年", "总得分": 37.1853810731, "政策数量": 15.8719770678, "政策质量": 63.7477836364, "协同机制": 52.8508541234, "防控重大疾病": 6, "全方位干预健康影响因素": 21, "维护全生命周期健康": 36, "按时完成率": 67.3913043478, "总体完成率": 95.652173913, "平均完成月数": 10.3863636364, "发文联合率": 36.231884058, "平均协作规模": 2.2753623188, "参与部门数量": 34 },
                { "省市名称": "北京", "年份": "2022年", "总得分": 36.0005047444, "政策数量": 13.5499961873, "政策质量": 62.5929484422, "协同机制": 51.147874668, "防控重大疾病": 7, "全方位干预健康影响因素": 15, "维护全生命周期健康": 40, "按时完成率": 47.8260869565, "总体完成率": 84.7826086957, "平均完成月数": 10.7948717949, "发文联合率": 41.5384615385, "平均协作规模": 2.2615384615, "参与部门数量": 38 },
                { "省市名称": "北京", "年份": "2023年", "总得分": 40.7501314462, "政策数量": 23.7836644097, "政策质量": 76.4974888201, "协同机制": 55.8656118714, "防控重大疾病": 22, "全方位干预健康影响因素": 23, "维护全生命周期健康": 51, "按时完成率": 71.7391304348, "总体完成率": 76.0869565217, "平均完成月数": 6.4571428571, "发文联合率": 24.7706422018, "平均协作规模": 1.9036697248, "参与部门数量": 49 }
            ];
        } else if (province === '重庆') {
            provinceData = [
                { "省市名称": "重庆", "年份": "2016年", "总得分": 23.3885061425, "政策数量": 8.6787366465, "政策质量": 59.0090886418, "协同机制": 23.5702546821, "防控重大疾病": 0, "全方位干预健康影响因素": 2, "维护全生命周期健康": 4, "按时完成率": 10.8695652174, "总体完成率": 89.1304347826, "平均完成月数": 42.7804878049, "发文联合率": 12.5, "平均协作规模": 1.25, "参与部门数量": 7 },
                { "省市名称": "重庆", "年份": "2017年", "总得分": 27.5682458824, "政策数量": 12.7194287116, "政策质量": 66.8158960751, "协同机制": 28.6920052849, "防控重大疾病": 0, "全方位干预健康影响因素": 3, "维护全生命周期健康": 6, "按时完成率": 19.5652173913, "总体完成率": 89.1304347826, "平均完成月数": 34.7317073171, "发文联合率": 11.1111111111, "平均协作规模": 1.1111111111, "参与部门数量": 6 },
                { "省市名称": "重庆", "年份": "2018年", "总得分": 24.7888176441, "政策数量": 9.2202239029, "政策质量": 66.8158960751, "协同机制": 23.6213031214, "防控重大疾病": 3, "全方位干预健康影响因素": 28, "维护全生命周期健康": 12, "按时完成率": 19.5652173913, "总体完成率": 89.1304347826, "平均完成月数": 34.7317073171, "发文联合率": 18.6046511628, "平均协作规模": 1.7441860465, "参与部门数量": 26 },
                { "省市名称": "重庆", "年份": "2019年", "总得分": 35.7279499619, "政策数量": 15.3734454501, "政策质量": 77.9626848883, "协同机制": 43.8089270249, "防控重大疾病": 4, "全方位干预健康影响因素": 20, "维护全生命周期健康": 8, "按时完成率": 43.4782608696, "总体完成率": 89.1304347826, "平均完成月数": 19.9024390244, "发文联合率": 18.4210526316, "平均协作规模": 1.6315789474, "参与部门数量": 18 },
                { "省市名称": "重庆", "年份": "2020年", "总得分": 37.4291358005, "政策数量": 17.1242583338, "政策质量": 63.083896101, "协同机制": 51.6350821464, "防控重大疾病": 7, "全方位干预健康影响因素": 14, "维护全生命周期健康": 9, "按时完成率": 34.7826086957, "总体完成率": 78.2608695652, "平均完成月数": 17.25, "发文联合率": 5.5555555556, "平均协作规模": 1.4722222222, "参与部门数量": 22 },
                { "省市名称": "重庆", "年份": "2021年", "总得分": 39.3394831073, "政策数量": 22.1369043769, "政策质量": 83.3504264988, "协同机制": 47.0053664552, "防控重大疾病": 2, "全方位干预健康影响因素": 21, "维护全生命周期健康": 14, "按时完成率": 41.3043478261, "总体完成率": 73.9130434783, "平均完成月数": 14.2058823529, "发文联合率": 11.6279069767, "平均协作规模": 1.3720930233, "参与部门数量": 21 },
                { "省市名称": "重庆", "年份": "2022年", "总得分": 40.9204371925, "政策数量": 24.4152443915, "政策质量": 77.4228702386, "协同机制": 49.6072922431, "防控重大疾病": 1, "全方位干预健康影响因素": 23, "维护全生命周期健康": 12, "按时完成率": 39.1304347826, "总体完成率": 71.7391304348, "平均完成月数": 10.4242424242, "发文联合率": 10.8695652174, "平均协作规模": 1.5869565217, "参与部门数量": 26 },
                { "省市名称": "重庆", "年份": "2023年", "总得分": 39.3099164542, "政策数量": 28.4709718443, "政策质量": 62.8700503195, "协同机制": 48.8027137598, "防控重大疾病": 6, "全方位干预健康影响因素": 33, "维护全生命周期健康": 20, "按时完成率": 63.0434782609, "总体完成率": 67.3913043478, "平均完成月数": 4.0, "发文联合率": 18.75, "平均协作规模": 1.475, "参与部门数量": 28 }
            ];
        } else if (province === '福建') {
            provinceData = [
                { "省市名称": "福建", "年份": "2016年", "总得分": 34.215870854, "政策数量": 8.9416323463, "政策质量": 59.0362514611, "协同机制": 46.9924233565, "防控重大疾病": 1, "全方位干预健康影响因素": 6, "维护全生命周期健康": 10, "按时完成率": 39.1304347826, "总体完成率": 89.1304347826, "平均完成月数": 29.4634146341, "发文联合率": 5.5555555556, "平均协作规模": 1.0555555556, "参与部门数量": 6 },
                { "省市名称": "福建", "年份": "2017年", "总得分": 37.9589305935, "政策数量": 16.2605386549, "政策质量": 76.8348111936, "协同机制": 48.6056723334, "防控重大疾病": 9, "全方位干预健康影响因素": 2, "维护全生命周期健康": 10, "按时完成率": 41.3043478261, "总体完成率": 89.1304347826, "平均完成月数": 26.1951219512, "发文联合率": 20.0, "平均协作规模": 1.28, "参与部门数量": 10 },
                { "省市名称": "福建", "年份": "2018年", "总得分": 24.9173899563, "政策数量": 10.8418746783, "政策质量": 76.8348111936, "协同机制": 15.5421907254, "防控重大疾病": 8, "全方位干预健康影响因素": 4, "维护全生命周期健康": 6, "按时完成率": 41.3043478261, "总体完成率": 89.1304347826, "平均完成月数": 26.1951219512, "发文联合率": 26.0869565217, "平均协作规模": 2.3913043478, "参与部门数量": 22 },
                { "省市名称": "福建", "年份": "2019年", "总得分": 38.7230776079, "政策数量": 23.7149142864, "政策质量": 87.3452134359, "协同机制": 41.4219721516, "防控重大疾病": 2, "全方位干预健康影响因素": 8, "维护全生命周期健康": 5, "按时完成率": 34.7826086957, "总体完成率": 89.1304347826, "平均完成月数": 19.2195121951, "发文联合率": 35.2941176471, "平均协作规模": 2.0588235294, "参与部门数量": 15 },
                { "省市名称": "福建", "年份": "2020年", "总得分": 31.7165373664, "政策数量": 20.468801742, "政策质量": 76.0351371491, "协同机制": 28.2755941682, "防控重大疾病": 4, "全方位干预健康影响因素": 26, "维护全生命周期健康": 19, "按时完成率": 56.5217391304, "总体完成率": 89.1304347826, "平均完成月数": 13.4634146341, "发文联合率": 41.5094339623, "平均协作规模": 1.7547169811, "参与部门数量": 19 },
                { "省市名称": "福建", "年份": "2021年", "总得分": 43.0622702382, "政策数量": 21.3283647308, "政策质量": 85.737258891, "协同机制": 56.1094223032, "防控重大疾病": 8, "全方位干预健康影响因素": 23, "维护全生命周期健康": 15, "按时完成率": 50.0, "总体完成率": 86.9565217391, "平均完成月数": 11.85, "发文联合率": 38.0, "平均协作规模": 1.84, "参与部门数量": 27 },
                { "省市名称": "福建", "年份": "2022年", "总得分": 43.090656739, "政策数量": 21.4208784149, "政策质量": 68.025162299, "协同机制": 60.6606244837, "防控重大疾病": 5, "全方位干预健康影响因素": 16, "维护全生命周期健康": 28, "按时完成率": 60.8695652174, "总体完成率": 84.7826086957, "平均完成月数": 8.358974359, "发文联合率": 34.375, "平均协作规模": 2.34375, "参与部门数量": 34 },
                { "省市名称": "福建", "年份": "2023年", "总得分": 45.8542874504, "政策数量": 37.0585652613, "政策质量": 81.7913016897, "协同机制": 49.7589954633, "防控重大疾病": 10, "全方位干预健康影响因素": 27, "维护全生命周期健康": 22, "按时完成率": 63.0434782609, "总体完成率": 76.0869565217, "平均完成月数": 6.9428571429, "发文联合率": 25.2873563218, "平均协作规模": 2.1724137931, "参与部门数量": 45 }
            ];
        } else if (province === '甘肃') {
            provinceData = [
                { "省市名称": "甘肃", "年份": "2016年", "总得分": 17.423574177, "政策数量": 5.5366769531, "政策质量": 58.5225889204, "协同机制": 6.2675730157, "防控重大疾病": 1, "全方位干预健康影响因素": 2, "维护全生命周期健康": 4, "按时完成率": 13.0434782609, "总体完成率": 91.3043478261, "平均完成月数": 39.4047619048, "发文联合率": 14.2857142857, "平均协作规模": 1.5714285714, "参与部门数量": 8 },
                { "省市名称": "甘肃", "年份": "2017年", "总得分": 23.1950147472, "政策数量": 9.592014371, "政策质量": 60.935554896, "协同机制": 20.0359815723, "防控重大疾病": 2, "全方位干预健康影响因素": 4, "维护全生命周期健康": 3, "按时完成率": 23.9130434783, "总体完成率": 91.3043478261, "平均完成月数": 33.7142857143, "发���联合率": 0.0, "平均协作规模": 1.0, "参与部门数量": 4 },
                { "省市名称": "甘肃", "年份": "2018年", "总得分": 32.3777781168, "政策数量": 8.3013241913, "政策质量": 60.935554896, "协同机制": 47.0248808482, "防控重大疾病": 0, "全方位干预健康影响因素": 5, "维护全生命周期健康": 7, "按时完成率": 23.9130434783, "总体完成率": 91.3043478261, "平均完成月数": 33.7142857143, "发文联合率": 7.1428571429, "平均协作规模": 1.0714285714, "参与部门数量": 7 },
                { "省市名称": "甘肃", "年份": "2019年", "总得分": 31.1642437811, "政策数量": 5.2510929547, "政策质量": 58.5883537518, "协同机制": 43.8714717547, "防控重大疾病": 5, "全方位干预健康影响因素": 16, "维护全生命周期健康": 9, "按时完成率": 43.4782608696, "总体完成率": 89.1304347826, "平均完成月数": 17.0975609756, "发文联合率": 29.0322580645, "平均协作规模": 2.0967741935, "参与部门数量": 24 },
                { "省市名称": "甘肃", "年份": "2020年", "总得分": 36.8368466484, "政策数量": 16.2720778217, "政策质量": 74.8685465779, "协同机制": 44.1581688881, "防控重大疾病": 8, "全方位干预健康影响因素": 13, "维护全生命周期健康": 4, "按时完成率": 45.652173913, "总体完成率": 84.7826086957, "平均完成月数": 13.1025641026, "发文联合率": 18.1818181818, "平均协作规模": 1.3333333333, "参与部门数量": 14 },
                { "省市名称": "甘肃", "年份": "2021年", "总得分": 36.7195189962, "政策数量": 16.7671132185, "政策质量": 70.0680050491, "协同机制": 46.955513513, "防控重大疾病": 10, "全方位干预健康影响因素": 8, "维护全生命周期健康": 19, "按时完成率": 58.6956521739, "总体完成率": 84.7826086957, "平均完成月数": 12.0512820513, "发文联合率": 13.9534883721, "平均协作规模": 1.3953488372, "参与部门数量": 17 },
                { "省市名称": "甘肃", "年份": "2022年", "总得分": 40.2787916021, "政策数量": 16.7077764957, "政策质量": 77.4965894382, "协同机制": 56.1638939831, "防控重大疾病": 3, "全方位干预健康影响因素": 20, "维护全生命周期健康": 6, "按时完成率": 36.9565217391, "总体完成率": 80.4347826087, "平均完成月数": 13.2432432432, "发文联合率": 26.4705882353, "平均协作规模": 2.0, "参与部门数量": 26 },
                { "省市名称": "甘肃", "年份": "2023年", "总得分": 38.2636347402, "政策数量": 21.4365742718, "政策质量": 75.8088198048, "协同机制": 52.7826109167, "防控重大疾病": 19, "全方位干预健康影响因素": 27, "维护全生命周期健康": 21, "按时完成率": 67.3913043478, "总体完成率": 80.4347826087, "平均完成月数": 7.0540540541, "发文联合率": 19.512195122, "平均协作规模": 1.5853658537, "参与部门数量": 31 }
            ];
        } else if (province === '广东') {
            provinceData = [
                { "省市名称": "广东", "年份": "2016年", "总得分": 18.6383207191, "政策数量": 2.4888666752, "政策质量": 38.9921058734, "协同机制": 20.6848566364, "防控重大疾病": 8, "全方位干预健康影响因素": 24, "维护全生命周期健康": 8, "按时完成率": 50.0, "总体完成率": 91.3043478261, "平均完成月数": 18.2380952381, "发文联合率": 23.4042553191, "平均协作规模": 1.8936170213, "参与部门数量": 25 },
                { "省市名称": "广东", "年份": "2017年", "总得分": 14.6701366789, "政策数量": 3.436371865, "政策质量": 47.9520558135, "协同机制": 1.2824694468, "防控重大疾病": 22, "全方位干预健康影响因素": 15, "维护全生命周期健康": 11, "按时完成率": 54.347826087, "总体完成率": 91.3043478261, "平均完成月数": 17.619047619, "发文联合率": 24.5614035088, "平均协作规模": 2.2631578947, "参与部门数量": 40 },
                { "省市名称": "广东", "年份": "2018年", "总得分": 15.9787039818, "政策数量": 3.6556266988, "政策质量": 47.9520558135, "协同机制": 7.875098242, "防控重大疾病": 6, "全方位干预健康影响因素": 18, "维护全生命周期健康": 10, "按时完成率": 54.347826087, "总体完成率": 91.3043478261, "平均完成月数": 17.619047619, "发文联合率": 30.0, "平均协作规模": 2.2, "参与部门数量": 29 },
                { "省市名称": "广东", "年份": "2019年", "总得分": 32.7761959342, "政策数量": 10.8506028515, "政策质量": 65.0478167017, "协同机制": 44.7232265008, "防控重大疾病": 6, "全方位干预健康影响因素": 14, "维护全生命周期健康": 12, "按时完成率": 43.4782608696, "总体完成率": 89.1304347826, "平均完成月数": 14.5853658537, "发文联合率": 48.8372093023, "平均协作规模": 2.6976744186, "参与部门数量": 36 },
                { "省市名称": "广东", "年份": "2020年", "总得分": 24.1308911284, "政策数量": 10.380676712, "政策质量": 65.8922218994, "协同机制": 21.5743774903, "防控重大疾病": 16, "全方位干预健康影响因素": 16, "维护全生命周期健康": 16, "按时完成率": 63.0434782609, "总体完成率": 86.9565217391, "平均完成月数": 10.55, "发文联合率": 27.4509803922, "平均协作规模": 1.9215686275, "参与部门数量": 29 },
                { "省市名称": "广东", "年份": "2021年", "总得分": 26.6426969688, "政策数量": 14.820419027, "政策质量": 74.9600184231, "协同机制": 21.434508108, "防控重大疾病": 7, "全方位干预健康影响因素": 21, "维护全生命周期健康": 21, "按时完成率": 52.1739130435, "总体完成率": 76.0869565217, "平均完成月数": 9.8857142857, "发文联合率": 40.7407407407, "平均协作规模": 1.9444444444, "参与部门数量": 29 },
                { "省市名称": "广东", "年份": "2022年", "总得分": 30.6895302544, "政策数量": 9.8105839774, "政策质量": 58.2299185116, "协同机制": 42.4995919489, "防控重大疾病": 4, "全方位干预健康影响因素": 11, "维护全生命周期健康": 15, "按时完成率": 50.0, "总体完成率": 73.9130434783, "平均完成月数": 8.6470588235, "发文联合率": 29.2682926829, "平均协作规模": 2.0, "参与部门数量": 32 },
                { "省市名称": "广东", "年份": "2023年", "总得分": 34.2902836582, "政策数量": 27.0385051273, "政策质量": 80.477253139, "协同机制": 33.7701397921, "防控重大疾病": 6, "全方位干预健康影响因素": 25, "维护全生命周期健康": 24, "按时完成率": 60.8695652174, "总体完成率": 65.2173913043, "平均完成月数": 6.4666666667, "发文联合率": 32.9411764706, "平均协作规模": 2.3058823529, "参与部门数量": 43 }
            ];
        } else if (province === '广西') {
            provinceData = [
                {"省市名称":"广西","年份":"2016年","总得分":32.2480513206,"政策数量":14.9087512629,"政策质量":69.9862080605,"协同机制":38.5430273612,"防控重大疾病":4,"全方位干预健康影响因素":2,"维护全生命周期健康":8,"按时完成率":26.0869565217,"总体完成率":89.1304347826,"平均完成月数":30.0243902439,"发文联合率":0.0,"平均协作规模":1.0,"参与部门数量":4},
                {"省市名称":"广西","年份":"2017年","总得分":40.1203172433,"政策数量":22.3313203877,"政策质量":73.0871126649,"协同机制":51.7226878632,"防控重大疾病":10,"全方位干预健康影响因素":8,"维护全生命周期健康":7,"按时完成率":47.8260869565,"总体完成率":89.1304347826,"平均完成月数":24.512195122,"发文联合率":13.7931034483,"平均协作规模":1.2413793103,"参与部门数量":10},
                {"省市名称":"广西","年份":"2018年","总得分":35.7667586982,"政策数量":12.4146526355,"政策质量":73.0871126649,"协同机制":49.1238134838,"防控重大疾病":1,"全方位干预健康影响因素":17,"维护全生命周期健康":6,"按时完成率":47.8260869565,"总体完成率":89.1304347826,"平均完成月数":24.512195122,"发文联合率":16.0,"平均协作规模":2.32,"参与部门数量":29},
                {"省市名称":"广西","年份":"2019年","总得分":43.1191973345,"政策数量":11.8330207341,"政策质量":65.7801492142,"协同机制":71.2242234308,"防控重大疾病":3,"全方位干预健康影响因素":7,"维护全生命周期健康":13,"按时完成率":39.1304347826,"总体完成率":89.1304347826,"平均完成月数":18.3902439024,"发文联合率":31.0344827586,"平均协作规模":2.1379310345,"参与部门数量":20},
                {"省市名称":"广西","年份":"2020年","总得分":36.721639212,"政策数量":20.2320905618,"政策质量":79.2083055908,"协同机制":43.0548843078,"防控重大疾病":14,"全方位干预健康影响因素":7,"维护全生命周期健康":8,"按时完成率":50.0,"总体完成率":84.7826086957,"平均完成月数":14.7179487179,"发文联合率":20.5128205128,"平均协作规模":1.5384615385,"参与部门数量":25},
                {"省市名称":"广西","年份":"2021年","总得分":38.0902584965,"政策数量":17.360969514,"政策质量":67.6498310412,"协同机制":51.1192544151,"防控重大疾病":2,"全方位干预健康影响因素":29,"维护全生命周期健康":23,"按时完成率":45.652173913,"总体完成率":73.9130434783,"平均完成月数":13.6764705882,"发文联合率":15.5172413793,"平均协作规模":1.4655172414,"参与部门数量":26},
                {"省市名称":"广西","年份":"2022年","总得分":33.2235698722,"政策数量":10.5458267753,"政策质量":65.6604885053,"协同机制":46.6827410751,"防控重大疾病":4,"全方位干预健康影响因素":17,"维护全生命周期健康":16,"按时完成率":39.1304347826,"总体完成率":69.5652173913,"平均完成月数":10.6875,"发文联合率":18.6046511628,"平均协作规模":1.2558139535,"参与部门数量":18},
                {"省市名称":"广西","年份":"2023年","总得分":38.6124780178,"政策数量":18.8272736615,"政策质量":70.0364042519,"协同机制":58.5570932613,"防控重大疾病":5,"全方位干预健康影响因素":20,"维护全生命周期健康":21,"按时完成率":54.347826087,"总体完成率":60.8695652174,"平均完成月数":5.7857142857,"发文联合率":33.8235294118,"平均协作规模":1.7352941176,"参与部门数量":26}
            ];
        } else {
            console.error(`暂无${province}的数据`);
            return;
        }

        // 创建弹出框
        let popupDiv = document.createElement('div');
        popupDiv.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            height: 80%;
            background: rgba(0,19,42,0.9);
            border: 1px solid rgba(255,255,255,.2);
            z-index: 1000;
            padding: 20px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
        `;

        // 创建切换按钮容器
        let buttonContainer = document.createElement('div');
        buttonContainer.style.cssText = `
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        `;

        // 创建三个切换按钮，包含总指标和细化指标
        const buttons = [
            {
                text: '总得分',
                type: 'total_score',
                mainIndicator: '总得分',
                indicators: []
            },
            {
                text: '政策数量',
                type: 'policy_count',
                mainIndicator: '政策数量',
                indicators: ['防控重大疾病', '全方位干预健康影响因素', '维护全生命周期健康']
            },
            {
                text: '政策质量',
                type: 'policy_quality',
                mainIndicator: '政策质量',
                indicators: ['按时完成率', '总体完成率', '平均完成月数']
            },
            {
                text: '协同机制',
                type: 'coordination',
                mainIndicator: '协同机制',
                indicators: ['发文联合率', '平均协作规模', '参与部门数量']
            }
        ];

        buttons.forEach(btn => {
            let button = document.createElement('button');
            button.textContent = btn.text;
            button.style.cssText = `
                padding: 8px 16px;
                background: rgba(98,201,141,0.2);
                border: 1px solid #62c98d;
                color: #fff;
                border-radius: 4px;
                cursor: pointer;
                transition: all 0.3s;
            `;
            button.onmouseover = () => button.style.background = 'rgba(98,201,141,0.4)';
            button.onmouseout = () => button.style.background = 'rgba(98,201,141,0.2)';
            button.onclick = () => {
                // 移除所有按钮的活跃状态
                buttonContainer.querySelectorAll('button').forEach(b =>
                    b.style.background = 'rgba(98,201,141,0.2)');
                // 设置当前按钮为活跃状态
                button.style.background = 'rgba(98,201,141,0.6)';
                updateChart(btn.type, btn.mainIndicator, btn.indicators);
            };
            buttonContainer.appendChild(button);
        });

        popupDiv.appendChild(buttonContainer);

        // 创建图表容器
        let chartDiv = document.createElement('div');
        chartDiv.style.cssText = 'flex: 1; width: 100%;';
        popupDiv.appendChild(chartDiv);

        // 添加关闭按钮
        let closeButton = document.createElement('button');
        closeButton.innerHTML = '×';
        closeButton.style.cssText = `
            position: absolute;
            right: 10px;
            top: 10px;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        `;
        closeButton.onclick = () => document.body.removeChild(popupDiv);
        popupDiv.appendChild(closeButton);

        document.body.appendChild(popupDiv);

        // 初始化图表
        let provinceChart = echarts.init(chartDiv);

        function updateChart(type, mainIndicator, indicators) {
            let option = {
                title: {
                    text: type === 'total_score' ? '总得分趋势' :
                        type === 'policy_count' ? '政策数量趋势' :
                            type === 'policy_quality' ? '政策质量趋势' : '协同机制趋势',
                    textStyle: {
                        color: '#fff',
                        fontSize: 16
                    },
                    left: 'center'
                },
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0,0,0,0.7)',
                    borderColor: '#fff',
                    textStyle: { color: '#fff' }
                },
                legend: {
                    show: type !== 'total_score',
                    data: type === 'total_score' ? [mainIndicator] : [mainIndicator, ...indicators],
                    textStyle: { color: '#fff' },
                    top: 30
                },
                grid: {
                    top: type === 'total_score' ? '15%' : '20%',
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023'],
                    axisLabel: {
                        show: true,
                        interval: 0,
                        color: 'rgba(255,255,255,.6)',
                        rotate: 45
                    },
                    axisLine: {
                        lineStyle: {
                            color: 'rgba(255,255,255,.2)'
                        }
                    }
                },
                yAxis: {
                    type: 'value',
                    name: type === 'total_score' ? '得分' : '',
                    nameTextStyle: {
                        color: 'rgba(255,255,255,.6)'
                    },
                    axisLabel: {
                        color: 'rgba(255,255,255,.6)'
                    },
                    axisLine: {
                        lineStyle: {
                            color: 'rgba(255,255,255,.2)'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: 'rgba(255,255,255,.1)',
                            type: 'dashed'
                        }
                    }
                },
                series: type === 'total_score' ?
                    [{
                        name: mainIndicator,
                        type: 'line',
                        data: provinceData.map(item => item[mainIndicator]),
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 10,
                        lineStyle: {
                            width: 4
                        },
                        itemStyle: {
                            color: '#62c98d',
                            borderWidth: 2,
                            borderColor: '#fff'
                        },
                        areaStyle: {
                            color: {
                                type: 'linear',
                                x: 0,
                                y: 0,
                                x2: 0,
                                y2: 1,
                                colorStops: [{
                                    offset: 0,
                                    color: 'rgba(98,201,141,0.5)'
                                }, {
                                    offset: 1,
                                    color: 'rgba(98,201,141,0.1)'
                                }]
                            }
                        }
                    }] :
                    [
                        {
                            name: mainIndicator,
                            type: 'line',
                            data: provinceData.map(item => item[mainIndicator]),
                            smooth: true,
                            symbol: 'circle',
                            symbolSize: 10,
                            lineStyle: {
                                width: 4
                            },
                            itemStyle: {
                                color: '#62c98d',
                                borderWidth: 2,
                                borderColor: '#fff'
                            }
                        },
                        ...indicators.map((indicator, index) => ({
                            name: indicator,
                            type: 'line',
                            data: provinceData.map(item => item[indicator]),
                            smooth: true,
                            symbol: 'circle',
                            symbolSize: 8,
                            lineStyle: {
                                width: 2
                            }
                        }))
                    ]
            };

            provinceChart.setOption(option);
        }

        // 初始显示总得分及其细化指标
        const firstButton = buttonContainer.querySelector('button');
        firstButton.style.background = 'rgba(98,201,141,0.6)';
        updateChart('total_score', buttons[0].mainIndicator, buttons[0].indicators);

        // 监听窗口调整
        window.addEventListener('resize', () => {
            provinceChart.resize();
        });
    }

    map();
});

